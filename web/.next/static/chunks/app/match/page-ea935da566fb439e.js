(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[684],{63:(e,t,r)=>{"use strict";var n=r(7260);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},65:(e,t,r)=>{Promise.resolve().then(r.bind(r,7151))},1150:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let n=r(5155),u=r(2115),l=r(4437);function o(e){return{default:e&&"default"in e?e.default:e}}r(6552);let a={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},c=function(e){let t={...a,...e},r=(0,u.lazy)(()=>t.loader().then(o)),c=t.loading;function s(e){let o=c?(0,n.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,a=!t.ssr||!!t.loading,s=a?u.Suspense:u.Fragment,i=t.ssr?(0,n.jsxs)(n.Fragment,{children:[null,(0,n.jsx)(r,{...e})]}):(0,n.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(r,{...e})});return(0,n.jsx)(s,{...a?{fallback:o}:{},children:i})}return s.displayName="LoadableComponent",s}},2577:(e,t,r)=>{"use strict";r.d(t,{BotsProvider:()=>d,E:()=>f});var n,u=r(5155),l=r(2115),o=r(2758),a=r(5704);let c="dots-duel-current-bot",s=null!=(n=a.env.NEXT_PUBLIC_WS_URL)?n:"ws://localhost:8000",i=(0,l.createContext)(void 0);function d(e){let{children:t}=e,[r,n]=(0,l.useState)(null),[a,d]=(0,l.useState)("disconnected"),f=(0,l.useRef)(null),b=(0,l.useRef)(0),y=(0,l.useRef)(null),g=(0,l.useRef)(new Map),m=(0,l.useRef)(new Map),p=()=>{y.current&&(clearTimeout(y.current),y.current=null)};function h(e){let t=g.current.get(e);if(!t||0===t.size)return;let r=m.current.get(e);if(!r||0===r.length)return;let n=r.splice(0,r.length);for(let r of(m.current.set(e,[]),n))for(let e of t)try{e(r)}catch(e){console.error(e)}}let v=(0,l.useCallback)(e=>!!f.current&&f.current.readyState===WebSocket.OPEN&&(f.current.send(JSON.stringify(e)),!0),[]),S=(0,l.useCallback)(e=>{try{sessionStorage.setItem(c,JSON.stringify(e))}catch(e){}},[]),O=(0,l.useCallback)(()=>{try{{let e=sessionStorage.getItem(c);return e?JSON.parse(e):null}}catch(e){return null}},[]),P=(0,l.useCallback)((e,t)=>{let r=g.current.get(e);return r||(r=new Set,g.current.set(e,r)),r.add(t),h(e),()=>{let r=g.current.get(e);r&&(r.delete(t),0===r.size&&g.current.delete(e))}},[]),_=(0,l.useCallback)(()=>{let e=O();if(!e||f.current&&(f.current.readyState===WebSocket.OPEN||f.current.readyState===WebSocket.CONNECTING))return;p(),d("connecting");let t=new WebSocket("".concat(s,"/ws/").concat(e.id));f.current=t,t.onopen=()=>{b.current=0,d("connected")},t.onmessage=e=>{try{var t,r=JSON.parse(e.data);let n=null!=(t=m.current.get(r.type))?t:[];n.push(r),m.current.set(r.type,n),h(r.type)}catch(e){console.error("Error parsing WebSocket message:",e)}},t.onclose=e=>{if(f.current=null,d("disconnected"),1e3!==e.code){let e=Math.min(b.current+1,5);b.current=e;let t=Math.min(1e3*2**(e-1),8e3);p(),y.current=setTimeout(()=>_(),t)}},t.onerror=()=>{d("error")}},[]),j=(0,l.useCallback)(()=>{p();let e=f.current;if(f.current=null,e)try{(e.readyState===WebSocket.OPEN||e.readyState===WebSocket.CONNECTING)&&e.close(1e3)}catch(e){}},[]);(0,l.useEffect)(()=>{_();let e=O(),t=null!=e?e:{id:Math.random().toString().slice(2,10),type:o.Y.MANUAL};return n(t),e||S(t),()=>{j()}},[]);let C=(0,l.useMemo)(()=>({saveBotToSession:S,currentBot:r,setCurrentBot:n,connectionStatus:a,sendWebSocketMessage:v,onMessage:P,connectWebSocket:_,disconnectWebSocket:j}),[_,a,r,j,P,S,v]);return(0,u.jsx)(i.Provider,{value:C,children:t})}function f(){let e=(0,l.useContext)(i);if(!e)throw Error("useBots must be used within a BotsProvider");return e}},2758:(e,t,r)=>{"use strict";r.d(t,{Y:()=>n});var n=function(e){return e.AUTO="auto",e.MANUAL="manual",e}({})},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{bindSnapshot:function(){return o},createAsyncLocalStorage:function(){return l},createSnapshot:function(){return a}});let r=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class n{disable(){throw r}getStore(){}run(){throw r}exit(){throw r}enterWith(){throw r}static bind(e){return e}}let u="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function l(){return u?new u:new n}function o(e){return u?u.bind(e):n.bind(e)}function a(){return u?u.snapshot():function(e,...t){return e(...t)}}},4437:(e,t,r)=>{"use strict";function n(e){let{reason:t,children:r}=e;return r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}}),r(4553)},6011:(e,t,r)=>{"use strict";r.d(t,{TournamentsProvider:()=>o,Y:()=>a});var n=r(5155),u=r(2115);let l=(0,u.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,u.useState)([]),[a,c]=(0,u.useState)(null);return(0,n.jsx)(l.Provider,{value:{tournaments:r,setTournaments:o,currentTournament:a,setCurrentTournament:c},children:t})}function a(){let e=(0,u.useContext)(l);if(void 0===e)throw Error("useTournaments must be used within a TournamentsProvider");return e}},6278:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return u}});let n=r(8140)._(r(1150));function u(e,t){var r;let u={};"function"==typeof e&&(u.loader=e);let l={...u,...t};return(0,n.default)({...l,modules:null==(r=l.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6552:(e,t,r)=>{"use strict";function n(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return n}}),r(5155),r(7650),r(8567),r(7278)},7151:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var n=r(5155),u=r(6278),l=r.n(u),o=r(2115),a=r(63),c=r(6011),s=r(9026),i=r(2577);let d=l()(()=>Promise.all([r.e(413),r.e(716),r.e(589)]).then(r.bind(r,6589)).then(e=>({default:e.GameDashboard})),{loadableGenerated:{webpack:()=>[6589]},ssr:!1,loading:()=>(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsx)("div",{className:"text-xl text-gray-600",children:"Loading game board..."})})});function f(){let{currentTournament:e}=(0,c.Y)(),{currentBot:t}=(0,i.E)(),r=(0,a.useRouter)(),u=!e||!t||e.status===s.me.COMPLETED;return((0,o.useEffect)(()=>{u&&r.replace("/")},[u,r]),u)?null:(0,n.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,n.jsx)(d,{initialTournament:e,currentBot:t})})}},7828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return n}});let n=(0,r(4054).createAsyncLocalStorage)()},8567:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return n.workAsyncStorageInstance}});let n=r(7828)},9026:(e,t,r)=>{"use strict";r.d(t,{Nr:()=>u,Zm:()=>l,me:()=>n});var n=function(e){return e.UPCOMING="upcoming",e.ACTIVE="active",e.COMPLETED="completed",e}({});let u=30,l=30}},e=>{e.O(0,[441,255,358],()=>e(e.s=65)),_N_E=e.O()}]);